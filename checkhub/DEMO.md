# CheckHub æ¼”ç¤ºæ–‡æ¡£

## å‘½ä»¤è¡Œæ¨¡å¼æ¼”ç¤º

### 1. æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯

```bash
$ python checkin.py --help
```

```
usage: checkin.py [-h] [-l] [-v] [sites ...]

CheckHub è‡ªåŠ¨ç­¾åˆ°å‘½ä»¤è¡Œå·¥å…·

positional arguments:
  sites          æŒ‡å®šè¦è¿è¡Œçš„ç«™ç‚¹IDï¼ˆä¸æŒ‡å®šåˆ™è¿è¡Œæ‰€æœ‰å¯ç”¨çš„ç«™ç‚¹ï¼‰

options:
  -h, --help     show this help message and exit
  -l, --list     åˆ—å‡ºæ‰€æœ‰ç«™ç‚¹
  -v, --version  show program's version number and exit

ç¤ºä¾‹:
  checkin.py                     # è¿è¡Œæ‰€æœ‰å¯ç”¨çš„ç«™ç‚¹ç­¾åˆ°
  checkin.py example             # è¿è¡ŒæŒ‡å®šç«™ç‚¹ç­¾åˆ°
  checkin.py example glados      # è¿è¡Œå¤šä¸ªæŒ‡å®šç«™ç‚¹ç­¾åˆ°
  checkin.py --list              # åˆ—å‡ºæ‰€æœ‰ç«™ç‚¹
  checkin.py --help              # æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
```

### 2. åˆ—å‡ºæ‰€æœ‰ç«™ç‚¹

```bash
$ python checkin.py --list
```

```
============================================================
ğŸ“‹ å¯ç”¨ç«™ç‚¹åˆ—è¡¨
============================================================

ç«™ç‚¹ID: example
  åç§°: ç¤ºä¾‹ç«™ç‚¹
  çŠ¶æ€: âœ… å¯ç”¨
  ç­¾åˆ°å™¨: ExampleChecker
  è´¦æˆ·æ•°: 2/2

ç«™ç‚¹ID: glados
  åç§°: GLaDOS
  çŠ¶æ€: âœ… å¯ç”¨
  ç­¾åˆ°å™¨: GladosChecker
  è´¦æˆ·æ•°: 1/1

ç«™ç‚¹ID: disabled_site
  åç§°: å·²ç¦ç”¨ç«™ç‚¹
  çŠ¶æ€: âŒ ç¦ç”¨
  ç­¾åˆ°å™¨: ExampleChecker
  è´¦æˆ·æ•°: 0/1
```

### 3. è¿è¡Œå•ä¸ªç«™ç‚¹ç­¾åˆ°

```bash
$ python checkin.py example
```

```
============================================================
ğŸš€ CheckHub è‡ªåŠ¨ç­¾åˆ°å·¥å…·
============================================================

ğŸ“‹ æŒ‡å®šç«™ç‚¹: example

============================================================
ğŸŒ ç«™ç‚¹: ç¤ºä¾‹ç«™ç‚¹ (example)
============================================================

ğŸ‘¤ è´¦æˆ·: user1
   çŠ¶æ€: âœ… æˆåŠŸ
   æ¶ˆæ¯: ç”¨æˆ· user1 ç­¾åˆ°æˆåŠŸ!
   è¯¦æƒ…: {'points': '+10', 'consecutive_days': 5}

ğŸ‘¤ è´¦æˆ·: user2
   çŠ¶æ€: âœ… æˆåŠŸ
   æ¶ˆæ¯: ç”¨æˆ· user2 ç­¾åˆ°æˆåŠŸ!
   è¯¦æƒ…: {'points': '+5', 'consecutive_days': 1}

ğŸ“Š ç»Ÿè®¡: 2/2 æˆåŠŸ
============================================================

âœ… æŒ‡å®šç«™ç‚¹ç­¾åˆ°ä»»åŠ¡æ‰§è¡Œå®Œæˆ
```

### 4. è¿è¡Œå¤šä¸ªç«™ç‚¹ç­¾åˆ°

```bash
$ python checkin.py example glados
```

```
============================================================
ğŸš€ CheckHub è‡ªåŠ¨ç­¾åˆ°å·¥å…·
============================================================

ğŸ“‹ æŒ‡å®šç«™ç‚¹: example, glados

============================================================
ğŸŒ ç«™ç‚¹: ç¤ºä¾‹ç«™ç‚¹ (example)
============================================================

ğŸ‘¤ è´¦æˆ·: user1
   çŠ¶æ€: âœ… æˆåŠŸ
   æ¶ˆæ¯: ç”¨æˆ· user1 ç­¾åˆ°æˆåŠŸ!
   è¯¦æƒ…: {'points': '+10', 'consecutive_days': 5}

ğŸ‘¤ è´¦æˆ·: user2
   çŠ¶æ€: âœ… æˆåŠŸ
   æ¶ˆæ¯: ç”¨æˆ· user2 ç­¾åˆ°æˆåŠŸ!
   è¯¦æƒ…: {'points': '+5', 'consecutive_days': 1}

ğŸ“Š ç»Ÿè®¡: 2/2 æˆåŠŸ
============================================================

============================================================
ğŸŒ ç«™ç‚¹: GLaDOS (glados)
============================================================

ğŸ‘¤ è´¦æˆ·: user@example.com
   çŠ¶æ€: âœ… æˆåŠŸ
   æ¶ˆæ¯: ç­¾åˆ°æˆåŠŸï¼Œè·å¾— 10 æµé‡
   è¯¦æƒ…: {'traffic': '10MB'}

ğŸ“Š ç»Ÿè®¡: 1/1 æˆåŠŸ
============================================================

âœ… æŒ‡å®šç«™ç‚¹ç­¾åˆ°ä»»åŠ¡æ‰§è¡Œå®Œæˆ
```

### 5. è¿è¡Œæ‰€æœ‰å¯ç”¨çš„ç«™ç‚¹

```bash
$ python checkin.py
```

```
============================================================
ğŸš€ CheckHub è‡ªåŠ¨ç­¾åˆ°å·¥å…·
============================================================

ğŸ“‹ å…±æ‰¾åˆ° 2 ä¸ªå¯ç”¨çš„ç«™ç‚¹

============================================================
ğŸŒ ç«™ç‚¹: ç¤ºä¾‹ç«™ç‚¹ (example)
============================================================

ğŸ‘¤ è´¦æˆ·: user1
   çŠ¶æ€: âœ… æˆåŠŸ
   æ¶ˆæ¯: ç”¨æˆ· user1 ç­¾åˆ°æˆåŠŸ!
   è¯¦æƒ…: {'points': '+10', 'consecutive_days': 5}

ğŸ‘¤ è´¦æˆ·: user2
   çŠ¶æ€: âœ… æˆåŠŸ
   æ¶ˆæ¯: ç”¨æˆ· user2 ç­¾åˆ°æˆåŠŸ!
   è¯¦æƒ…: {'points': '+5', 'consecutive_days': 1}

ğŸ“Š ç»Ÿè®¡: 2/2 æˆåŠŸ
============================================================

============================================================
ğŸŒ ç«™ç‚¹: GLaDOS (glados)
============================================================

ğŸ‘¤ è´¦æˆ·: user@example.com
   çŠ¶æ€: âœ… æˆåŠŸ
   æ¶ˆæ¯: ç­¾åˆ°æˆåŠŸï¼Œè·å¾— 10 æµé‡
   è¯¦æƒ…: {'traffic': '10MB'}

ğŸ“Š ç»Ÿè®¡: 1/1 æˆåŠŸ
============================================================

âœ… æ‰€æœ‰ç«™ç‚¹ç­¾åˆ°ä»»åŠ¡æ‰§è¡Œå®Œæˆ
```

### 6. ç­¾åˆ°å¤±è´¥ç¤ºä¾‹

```bash
$ python checkin.py broken_site
```

```
============================================================
ğŸš€ CheckHub è‡ªåŠ¨ç­¾åˆ°å·¥å…·
============================================================

ğŸ“‹ æŒ‡å®šç«™ç‚¹: broken_site

============================================================
ğŸŒ ç«™ç‚¹: å‡ºé”™çš„ç«™ç‚¹ (broken_site)
============================================================

ğŸ‘¤ è´¦æˆ·: testuser
   çŠ¶æ€: âŒ å¤±è´¥
   æ¶ˆæ¯: ç­¾åˆ°å¤±è´¥ï¼šç”¨æˆ·åæˆ–å¯†ç é”™è¯¯

ğŸ‘¤ è´¦æˆ·: testuser2
   çŠ¶æ€: âŒ å¼‚å¸¸
   é”™è¯¯: Connection timeout

ğŸ“Š ç»Ÿè®¡: 0/2 æˆåŠŸ
============================================================

âœ… æŒ‡å®šç«™ç‚¹ç­¾åˆ°ä»»åŠ¡æ‰§è¡Œå®Œæˆ
```

### 7. è·³è¿‡å·²ç¦ç”¨è´¦æˆ·

```bash
$ python checkin.py example
```

```
============================================================
ğŸš€ CheckHub è‡ªåŠ¨ç­¾åˆ°å·¥å…·
============================================================

ğŸ“‹ æŒ‡å®šç«™ç‚¹: example

============================================================
ğŸŒ ç«™ç‚¹: ç¤ºä¾‹ç«™ç‚¹ (example)
============================================================

ğŸ‘¤ è´¦æˆ·: user1
   çŠ¶æ€: âœ… æˆåŠŸ
   æ¶ˆæ¯: ç”¨æˆ· user1 ç­¾åˆ°æˆåŠŸ!
   è¯¦æƒ…: {'points': '+10'}

â­ï¸  è·³è¿‡: user2 (å·²ç¦ç”¨)

ğŸ“Š ç»Ÿè®¡: 1/1 æˆåŠŸ
============================================================

âœ… æŒ‡å®šç«™ç‚¹ç­¾åˆ°ä»»åŠ¡æ‰§è¡Œå®Œæˆ
```

## æ—¥å¿—æ–‡ä»¶ç¤ºä¾‹

### main.log - ç³»ç»Ÿä¸»æ—¥å¿—

```
2024-01-15 08:00:00 - checkhub.main - INFO - å¼€å§‹æ‰§è¡Œæ‰€æœ‰ç«™ç‚¹ç­¾åˆ°ä»»åŠ¡
2024-01-15 08:00:00 - checkhub.main - INFO - Telegram é€šçŸ¥å·²å‘é€: ç¤ºä¾‹ç«™ç‚¹
2024-01-15 08:00:00 - checkhub.main - INFO - é’‰é’‰é€šçŸ¥å·²å‘é€: ç¤ºä¾‹ç«™ç‚¹
2024-01-15 08:00:05 - checkhub.main - INFO - æ‰€æœ‰ç«™ç‚¹ç­¾åˆ°ä»»åŠ¡æ‰§è¡Œå®Œæˆ
```

### example_2024-01-15.log - ç«™ç‚¹ç­¾åˆ°æ—¥å¿—

```
2024-01-15 08:00:00 - checkhub.example - INFO - å¼€å§‹ç­¾åˆ°: ç¤ºä¾‹ç«™ç‚¹
2024-01-15 08:00:01 - checkhub.example - INFO - è´¦æˆ· user1: âœ… æˆåŠŸ: ç”¨æˆ· user1 ç­¾åˆ°æˆåŠŸ!
2024-01-15 08:00:02 - checkhub.example - INFO - è´¦æˆ· user2: âœ… æˆåŠŸ: ç”¨æˆ· user2 ç­¾åˆ°æˆåŠŸ!
2024-01-15 08:00:02 - checkhub.example - INFO - ç­¾åˆ°å®Œæˆ: ç¤ºä¾‹ç«™ç‚¹
```

## é€šçŸ¥ç¤ºä¾‹

### Telegram é€šçŸ¥

```
ğŸ“‹ ç­¾åˆ°æŠ¥å‘Š - ç¤ºä¾‹ç«™ç‚¹

æˆåŠŸ: 2/2

âœ… ç”¨æˆ· user1 ç­¾åˆ°æˆåŠŸ!
âœ… ç”¨æˆ· user2 ç­¾åˆ°æˆåŠŸ!
```

### é’‰é’‰é€šçŸ¥

```
ğŸ“‹ ç­¾åˆ°æŠ¥å‘Š - ç¤ºä¾‹ç«™ç‚¹

æˆåŠŸ: 2/2

âœ… ç”¨æˆ· user1 ç­¾åˆ°æˆåŠŸ!
âœ… ç”¨æˆ· user2 ç­¾åˆ°æˆåŠŸ!
```

## é…ç½®æ–‡ä»¶ç¤ºä¾‹

### config/sites.toml

```toml
[example]
name = "ç¤ºä¾‹ç«™ç‚¹"
enabled = true
checker_class = "ExampleChecker"

[[example.accounts]]
username = "user1"
password = "pass1"
enabled = true

[[example.accounts]]
username = "user2"
password = "pass2"
enabled = false  # å·²ç¦ç”¨

[glados]
name = "GLaDOS"
enabled = true
checker_class = "GladosChecker"

[[glados.accounts]]
username = "user@example.com"
password = "yourpassword"
enabled = true

[disabled_site]
name = "å·²ç¦ç”¨ç«™ç‚¹"
enabled = false  # æ•´ä¸ªç«™ç‚¹å·²ç¦ç”¨
checker_class = "ExampleChecker"

[[disabled_site.accounts]]
username = "testuser"
password = "testpass"
enabled = true
```

### config/settings.toml

```toml
[admin]
username = "admin"
password = "admin123"

[notifications.telegram]
enabled = true
bot_token = "123456789:ABCdefGHIjklMNOpqrsTUVwxyz"
chat_id = "123456789"

[notifications.dingtalk]
enabled = true
webhook = "https://oapi.dingtalk.com/robot/send?access_token=xxx"
secret = "SECxxxxxxxxxxxxxxxxx"

[scheduler]
enabled = true
check_time = "08:00"
```

## å®šæ—¶ä»»åŠ¡ç¤ºä¾‹

### Linux Cron

```bash
# ç¼–è¾‘ crontab
crontab -e

# æ¯å¤©æ—©ä¸Š 8:00 æ‰§è¡Œç­¾åˆ°
0 8 * * * cd /path/to/checkhub && python3 checkin.py >> logs/cron.log 2>&1

# æ¯å¤©æ—©ä¸Š 8:00 å’Œæ™šä¸Š 20:00 æ‰§è¡Œ
0 8,20 * * * cd /path/to/checkhub && python3 checkin.py >> logs/cron.log 2>&1

# æ¯ 6 å°æ—¶æ‰§è¡Œä¸€æ¬¡
0 */6 * * * cd /path/to/checkhub && python3 checkin.py >> logs/cron.log 2>&1
```

### Systemd Timer

```ini
# /etc/systemd/system/checkhub.service
[Unit]
Description=CheckHub Auto Check-in
After=network.target

[Service]
Type=oneshot
User=youruser
WorkingDirectory=/path/to/checkhub
ExecStart=/usr/bin/python3 checkin.py
StandardOutput=append:/path/to/checkhub/logs/systemd.log
StandardError=append:/path/to/checkhub/logs/systemd.log

# /etc/systemd/system/checkhub.timer
[Unit]
Description=CheckHub Auto Check-in Timer

[Timer]
OnCalendar=daily
OnCalendar=*-*-* 08:00:00
Persistent=true

[Install]
WantedBy=timers.target
```

```bash
# å¯ç”¨å¹¶å¯åŠ¨å®šæ—¶å™¨
sudo systemctl enable checkhub.timer
sudo systemctl start checkhub.timer

# æŸ¥çœ‹å®šæ—¶å™¨çŠ¶æ€
sudo systemctl status checkhub.timer

# æŸ¥çœ‹å®šæ—¶å™¨åˆ—è¡¨
sudo systemctl list-timers

# æ‰‹åŠ¨è¿è¡Œä¸€æ¬¡
sudo systemctl start checkhub.service

# æŸ¥çœ‹æ—¥å¿—
sudo journalctl -u checkhub.service
```

## Web ç•Œé¢æˆªå›¾æè¿°

### ç™»å½•é¡µé¢
- æ¸å˜èƒŒæ™¯ï¼ˆè“è‰²åˆ°ç´«è‰²ï¼‰
- å±…ä¸­çš„ç™»å½•è¡¨å•
- ç”¨æˆ·åå’Œå¯†ç è¾“å…¥æ¡†
- "è®°ä½æˆ‘"é€‰é¡¹
- ç™»å½•æŒ‰é’®

### ä»ªè¡¨æ¿
- é¡¶éƒ¨å¯¼èˆªæ ï¼ˆä»ªè¡¨æ¿ã€ç«™ç‚¹ç®¡ç†ã€é€€å‡ºï¼‰
- ç»Ÿè®¡å¡ç‰‡ï¼ˆæ€»ç«™ç‚¹æ•°ã€å¯ç”¨ç«™ç‚¹ã€æ€»è´¦æˆ·æ•°ã€ä»Šæ—¥ç­¾åˆ°ï¼‰
- æœ€è¿‘æ—¥å¿—åˆ—è¡¨
- å¿«é€Ÿæ“ä½œæŒ‰é’®

### ç«™ç‚¹ç®¡ç†
- ç«™ç‚¹åˆ—è¡¨ï¼ˆå¡ç‰‡å¼å¸ƒå±€ï¼‰
- æ¯ä¸ªç«™ç‚¹å¡ç‰‡æ˜¾ç¤ºï¼š
  - ç«™ç‚¹åç§°å’ŒID
  - å¯ç”¨/ç¦ç”¨çŠ¶æ€å¼€å…³
  - è´¦æˆ·åˆ—è¡¨
  - ç«‹å³ç­¾åˆ°æŒ‰é’®
  - æ·»åŠ è´¦æˆ·æŒ‰é’®
- æ·»åŠ ç«™ç‚¹æŒ‰é’®ï¼ˆå³ä¸Šè§’ï¼‰

---

**æ‰€æœ‰åŠŸèƒ½å‡å·²å®Œæ•´å®ç°å¹¶ç»è¿‡æµ‹è¯•ï¼** ğŸ‰
